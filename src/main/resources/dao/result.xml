<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ming.dao.Result">
	
	<!-- 歌单 根据歌单id给出歌单列表对象list-->
	<resultMap id="findSongList" type="com.ming.dao.pojo.Songlist">
		<constructor>
			<idArg column="id" javaType="int"/>
			<idArg column="singId" javaType="int"/>
			<idArg column="creator" javaType="int"/>
		</constructor>
		<result column="name" property="name"/>
		<result column="description" property="description"/>
	</resultMap>
	<select id="findSongList" parameterType="int" resultMap="findSongList" ><![CDATA[
		SELECT `id`, singId, `name`, `description`, `creator`
		FROM `songlist`.`songlist`
		WHERE `id` = #{id};
	]]></select>
	
	<!--用户 根据id给出用户对象-->
	<resultMap id="getUsers" type="com.ming.dao.pojo.Users">
		<id property="id" column="id"/>
		<result property="sex" column="sex" typeHandler="com.ming.dao.typeHandler.SexEnumTypeHandler"/>
		<result property="address" column="address"/>
		<association property="songlist" column="id" select="com.ming.dao.Result.findSongList"/>
	</resultMap>
	<select id="findUsers" parameterType="int" resultMap="getUsers"><![CDATA[
		SELECT `id`, `sex`, address
		FROM `songlist`.`users`
		WHERE `id` = #{id};
	]]></select>
	
	<!-- 歌曲对象 根据id查找出歌曲 -->
	<resultMap id="findFanySing" type="com.ming.dao.pojo.FanySing">
		<id property="id" column="id"/>
		<result property="category" column="category"/>
		<result property="issudate" column="issudate"/>
		<result property="language" column="language"/>
		<result property="name" column="name"/>
		<result property="singer" column="singer"/>
		<result property="writer" column="writer"/>
		<association property="songlist" column="id" select="com.ming.dao.Result.findSongList"/>
	</resultMap>
	<select id="findFanySing" parameterType="int" resultMap="findFanySing"><![CDATA[
		SELECT `id`,
		       `category`,
		       `issudate`,
		       `language`,
		       `name`,
		       `singer`,
		       `writer`
		FROM `songlist`.`fanysing`
		WHERE `songlist`.`fanysing`.`id` = #{id};
		]]></select>
	
	
	<!-- 歌曲列表 每次调用进行分页操作 -->
	<select id="listSing" resultMap="findFanySing"><![CDATA[
		SELECT `id`,
		       `category`,
		       `issudate`,
		       `language`,
		       `name`,
		       `singer`,
		       `writer`
		FROM `songlist`.`fanysing`
	]]></select>
	
	
	<update id="changeFanySing" parameterType="com.ming.dao.pojo.FanySing"><![CDATA[
		UPDATE songlist.fanysing SET songlist.fanysing.writer = #{writer}, songlist.fanysing.singer = #{singer} , songlist.fanysing.category = #{category},
		                             songlist.fanysing.name = #{name}, songlist.fanysing.language = #{language}, songlist.fanysing.issudate = #{issudate}
		                             WHERE songlist.fanysing.id = #{id}
	]]></update>
</mapper>